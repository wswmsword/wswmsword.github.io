!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self,function(){var e=t.focusBagel,r=t.focusBagel=n();r.noConflict=function(){return t.focusBagel=e,r}}())}(this,(function(){"use strict";function t(){t=function(){return n};var n={},e=Object.prototype,r=e.hasOwnProperty,o=Object.defineProperty||function(t,n,e){t[n]=e.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(t,n,e){return Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[n]}try{l({},"")}catch(t){l=function(t,n,e){return t[n]=e}}function f(t,n,e,r){var i=n&&n.prototype instanceof d?n:d,u=Object.create(i.prototype),a=new j(r||[]);return o(u,"_invoke",{value:b(t,e,a)}),u}function s(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}n.wrap=f;var v={};function d(){}function p(){}function h(){}var y={};l(y,u,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(N([])));g&&g!==e&&r.call(g,u)&&(y=g);var w=h.prototype=d.prototype=Object.create(y);function k(t){["next","throw","return"].forEach((function(n){l(t,n,(function(t){return this._invoke(n,t)}))}))}function x(t,n){function e(o,i,u,a){var c=s(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?n.resolve(f.__await).then((function(t){e("next",t,u,a)}),(function(t){e("throw",t,u,a)})):n.resolve(f).then((function(t){l.value=t,u(l)}),(function(t){return e("throw",t,u,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new n((function(n,o){e(t,r,n,o)}))}return i=i?i.then(o,o):o()}})}function b(t,n,e){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return O()}for(e.method=o,e.arg=i;;){var u=e.delegate;if(u){var a=E(u,e);if(a){if(a===v)continue;return a}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if("suspendedStart"===r)throw r="completed",e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);r="executing";var c=s(t,n,e);if("normal"===c.type){if(r=e.done?"completed":"suspendedYield",c.arg===v)continue;return{value:c.arg,done:e.done}}"throw"===c.type&&(r="completed",e.method="throw",e.arg=c.arg)}}}function E(t,n){var e=n.method,r=t.iterator[e];if(void 0===r)return n.delegate=null,"throw"===e&&t.iterator.return&&(n.method="return",n.arg=void 0,E(t,n),"throw"===n.method)||"return"!==e&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+e+"' method")),v;var o=s(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function L(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function I(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function N(t){if(t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var e=-1,o=function n(){for(;++e<t.length;)if(r.call(t,e))return n.value=t[e],n.done=!1,n;return n.value=void 0,n.done=!0,n};return o.next=o}}return{next:O}}function O(){return{value:void 0,done:!0}}return p.prototype=h,o(w,"constructor",{value:h,configurable:!0}),o(h,"constructor",{value:p,configurable:!0}),p.displayName=l(h,c,"GeneratorFunction"),n.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===p||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,l(t,c,"GeneratorFunction")),t.prototype=Object.create(w),t},n.awrap=function(t){return{__await:t}},k(x.prototype),l(x.prototype,a,(function(){return this})),n.AsyncIterator=x,n.async=function(t,e,r,o,i){void 0===i&&(i=Promise);var u=new x(f(t,e,r,o),i);return n.isGeneratorFunction(e)?u:u.next().then((function(t){return t.done?t.value:u.next()}))},k(w),l(w,c,"Generator"),l(w,u,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var n=Object(t),e=[];for(var r in n)e.push(r);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},n.values=N,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function e(e,r){return u.type="throw",u.arg=t,n.next=e,r&&(n.method="next",n.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;e>=0;--e){var o=this.tryEntries[e];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var u=i?i.completion:{};return u.type=t,u.arg=n,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(u)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),v},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),I(e),v}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var r=e.completion;if("throw"===r.type){var o=r.arg;I(e)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,e){return this.delegate={iterator:N(t),resultName:n,nextLoc:e},"next"===this.method&&(this.arg=void 0),v}},n}function n(t,n,e,r,o,i,u){try{var a=t[i](u),c=a.value}catch(t){return void e(t)}a.done?n(c):Promise.resolve(c).then(r,o)}function e(t){return function(){var e=this,r=arguments;return new Promise((function(o,i){var u=t.apply(e,r);function a(t){n(u,o,i,a,c,"next",t)}function c(t){n(u,o,i,a,c,"throw",t)}a(void 0)}))}}function r(){return r=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},r.apply(this,arguments)}function o(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function i(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(e)return(e=e.call(t)).next.bind(e);if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return o(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?o(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=function(t){return Object.prototype.toString.call(t)},a=function(t){return"[object Object]"===u(t)},c=function(t){return"[object Function]"===u(t)},l=function(){return document.activeElement},f=function(t){return"string"==typeof t?(n=t,document.querySelector(n)):t;var n},s=function(t){return"Enter"===t.key||13===t.keyCode},v=function(t){return"Escape"===t.key||"Esc"===t.key||27===t.keyCode},d=function(t){return"Tab"===t.key||9===t.keyCode},p=function(t){return d(t)&&!t.shiftKey},h=function(t){return d(t)&&t.shiftKey},y=function(t){var n;return t.focus(),(n=t).tagName&&"input"===n.tagName.toLowerCase()&&"function"==typeof n.select&&t.select(),!0},m=function(){var n=e(t().mark((function n(e){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){null==e?setTimeout((function(){return t(e&&y(e))}),0):t(y(e))})));case 1:case"end":return t.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),g=function(t,n,e){var r,o=n.map((function(t){return f(t)})).filter((function(t){return null!=t})),i=o[0],u=o.slice(-1)[0],a=null!==(r=f(t))&&void 0!==r?r:function(t,n){if(null==t||null==n)return null;if(t.contains(n))return t;if(n.contains(t))return n;var e=new Range;return e.setStartBefore(t),e.setEndAfter(n),e.collapsed&&(e.setStartBefore(n),e.setEndAfter(t)),e.commonAncestorContainer}(i,u);return{rootNode:a,subNodes:o,head:i,tail:u,coverNode:!0===e?a:f(e)}},w=function(t,n){var e=Array.isArray(n.node)?n.node.map((function(t){return r({},n,{node:t})})):n;return t.concat(e)},k=function(t,n,e,o,i,u){var a,l,s,d,p,h,y,m,g,k,x,b,E,L=[].concat(t).filter((function(t){return null!=t})).map((function(t){return r({},t,{type:void 0===t.type?[null==t.key?"":"keydown",null==t.node?"":"click"].filter((function(t){return""!==t})):[].concat(t.type)})})).reduce(w,[]),I=c(n)?n:!0===n?null!==(a=null===(l=L[0])||void 0===l?void 0:l.on)&&void 0!==a?a:function(){}:n,j=[c(I)?{node:null,key:v,on:I,target:e?o:i,type:["keydown"]}:null].concat(L).filter((function(t){return null!=t}));return r({exits:j},(s=j.reduce((function(t,n){var e,r=t[0],o=t[1],i=t[2],a=t[3],c=t[4],l=t[5],s=t[6],v=function(t){var e;return null===(e=n.type)||void 0===e?void 0:e.includes(t)};return null!=(e=n.node)&&u.contains(f(e))||null==e?(v("keydown")&&(r=r.concat(n)),v("click")&&(o=o.concat(n)),v("focus")&&(i=i.concat(n)),v("outlist")&&(s=s.concat(n))):(v("keydown")&&(a=a.concat(n)),v("click")&&(c=c.concat(n)),v("focus")&&(l=l.concat(n)),v("outlist")&&(s=s.concat(n))),[r,o,i,a,c,l,s]}),new Array(7).fill([])),d=s[0],p=s[1],h=s[2],y=s[3],m=s[4],g=s[5],k=s[6],x=p.length>0,b=h.length>0,E=d.length>0,{keyExits:d,clickExits:p,focusExits:h,hasClickExits:x,hasFocusExits:b,hasKeyExits:E,keyExits_wild:y,clickExits_wild:m,focusExits_wild:g,outListExits:k}))},x=function(t){var n=c(t),e=n&&t((function(){})),r=n&&"[object Promise]"===u(e),o=n&&!r;return{promiseDelay:r,callbackDelay:o,commonDelay:!0===t&&!r&&!o}},b=function(){var n=e(t().mark((function n(e,r){var o,i,u,a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e?x(e):{},i=o.promiseDelay,u=o.callbackDelay,a=o.commonDelay,!i){t.next=7;break}return t.next=4,e((function(){}));case 4:r(),t.next=16;break;case 7:if(!u){t.next=11;break}e(r),t.next=16;break;case 11:if(!a){t.next=15;break}r(),t.next=16;break;case 15:return t.abrupt("return",!0);case 16:case"end":return t.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}(),E=function(t,n,e,r,o,i){return void 0===i&&(i=0),null==t?o?n:e[-1===i?0:i]:c(t)?t({list:e,cover:n,root:r,last:e[i],lastI:i}):f(t)},L=function(){function t(){this.cache=[],this.isEmpty=!0}var n=t.prototype;return n.push=function(t,n,e){this.isEmpty=!1,this.cache.push({node:t,type:n,handler:e})},n.clean=function(){this.cache=[],this.isEmpty=!0},n.addListeners=function(){this.cache.forEach((function(t){var n;return null===(n=t.node)||void 0===n?void 0:n.addEventListener(t.type,t.handler)}))},n.removeListeners=function(){this.cache.forEach((function(t){var n;return null===(n=t.node)||void 0===n?void 0:n.removeEventListener(t.type,t.handler)})),this.clean()},t}(),I=function(){function t(){this.cache=new Map}var n=t.prototype;return n.has=function(t){return this.cache.has(t)},n.push=function(t,n,e){this.cache.has(t)||(n.addEventListener("keydown",e),this.cache.set(t,{node:n,handler:e}))},n.clean=function(){this.cache=new Map},n.remove=function(t){var n=this;[].concat(t).forEach((function(t){return n.cache.get(t).node.removeEventListener("keydown",n.cache.get(t).handler)}))},t}(),j=function(){function t(){this.data=[]}return t.prototype.update=function(t){this.data.splice(0,this.data.length),Array.prototype.push.apply(this.data,t)},t}();return function(){var n,o,u=0-((arguments.length<=0?void 0:arguments[0])instanceof Array),d=0+u<0||arguments.length<=0+u?void 0:arguments[0+u],x=1+u<0||arguments.length<=1+u?void 0:arguments[1+u],N=null!==(n=2+u<0||arguments.length<=2+u?void 0:arguments[2+u])&&void 0!==n?n:{},O=N.sequence,_=N.loop,A=N.next,D=N.prev,P=N.trigger,T=N.entry,S=N.exit,F=N.onEscape,C=N.onClick,G=N.onMove,M=N.cover,B=void 0!==M&&M,K=N.initialActive,q=N.correctionTarget,R=N.delayToFocus,Y=N.delayToBlur,U=N.removeListenersEachExit,$=void 0===U||U,z=N.removeListenersEachEnter,H=N.manual;N.demo;var J=a(B)?B:!0===B?{}:{node:B?d:null},Q=J.node,V=void 0===Q?d||!0:Q,W=J.enterKey,X=J.onEnter,Z=J.exit,tt=!!V,nt=new j,et=[].concat(T).filter((function(t){return null!=t})).map((function(t){return r({},t,{type:void 0===t.type?[null==t.key?"":"keydown",null==t.node?"":"click"].filter((function(t){return""!=t})):[].concat(t.type)})})).reduce(w,[]),rt=0===et.length,ot=f(P||(null===(o=et[0])||void 0===o?void 0:o.node)),it=[].concat(Z).filter((function(t){return null!=t})).map((function(t){var n;return r({},t,{target:null!==(n=t.target)&&void 0!==n?n:ot})})),ut=tt&&0===it.length,at=!1===F,ct=a(A)?A:{key:A},lt=ct.key,ft=ct.on,st=a(D)?D:{key:D},vt=st.key,dt=st.on,pt=!(null==_||_),ht=!!(lt||vt||O),yt=null!=K?K:-1,mt=-1,gt=new L,wt=!1,kt=!1,xt=new L,bt=new I,Et=null,Lt=null,It=null;if(!H&&(Ct(),(rt?[{}]:et).some((function(t){var n=t.delay;return!(null!=n?n:R)})))){var jt=g(d,x,V),Nt=jt.rootNode,Ot=jt.subNodes,_t=jt.head,At=jt.tail,Dt=jt.coverNode;nt.update(Ot),Ft(Nt,nt.data,_t,At,Dt)}var Pt={enter:function(t){if(ot=ot||l(),t){Tt({fromInvoke:!0},t.on,t.target,t.delay)}else{for(var n,e=function(){var t=n.value,e=t.on,r=t.type,o=t.node,i=t.target,u=t.delay;if(null!=r&&r.some((function(t){return null==t||!1===t||"invoke"===t}))||null==o)return Tt({fromInvoke:!0},e,i,u),"break"},r=i(et);!(n=r()).done;){if("break"===e())break}Tt({fromInvoke:!0})}},exit:function(t){if(t){var n=t.on,e=t.target;a(f(e),n)}else for(var r,o=function(){var t=r.value,n=t.on,e=t.type,o=t.target,i=f(o);if(null!=e&&e.some((function(t){return null==t||!1===t||"invoke"===t})))return a(i,n),"break"},u=i(It);!(r=u()).done;){if("break"===o())break}function a(t,n){var e,r;return t?null===(e=Et)||void 0===e?void 0:e({fromInvoke:!0},n,t):null===(r=Lt)||void 0===r?void 0:r({fromInvoke:!0},n,t)}},removeListeners:function(){gt.removeListeners(),xt.removeListeners()},addEntryListeners:function(){Ct()},addListRelatedListeners:function(){var t=g(d,x,V),n=t.rootNode,e=t.subNodes,r=t.head,o=t.tail,i=t.coverNode;nt.update(e),Ft(n,nt.data,r,o,i)},addForward:function(t,n){var e=null;if(c(n)){var r=g(d,x,V);e=n({root:r.rootNode,list:r.subNodes,head:r.head,tail:r.tail,cover:r.coverNode,curI:yt,prevI:mt})}else e=n;var o=e,i=o.node,u=o.on,a=o.key,l=o.target,s=f(i),v=f(l);bt.push(t,s,(function(t){null!=a&&a(t,yt)&&(t.preventDefault(),null==u||u(),m(v))}))},removeForward:function(t){bt.remove(t)},updateList:function(t){var n=t.map((function(t){return f(t)})).filter((function(t){return null!=t}));nt.update(n)},i:function(){return yt}};return Pt;function Tt(t,n,e,r){return St.apply(this,arguments)}function St(){return St=e(t().mark((function n(e,r,o,i){var u,a;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=function(t,n,r){var i=E(o,t,n,r,tt,yt),u=n.indexOf(i);u>-1&&(mt=yt,yt=u,null==G||G({e:e,prev:n[mt],cur:i,prevI:mt,curI:yt}),wt=!0),tt&&(i===t||u>-1)&&(kt=!0),m(i)},u=function(){var t=g(d,x,V),n=t.rootNode,e=t.subNodes,r=t.head,i=t.tail,u=t.coverNode;nt.update(e),Ft(n,nt.data,r,i,u),!1!==o&&a(u,e,n)},!kt&&!wt){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,null==r?void 0:r(e);case 6:!(null!=i?i:R)?u():b(i,u);case 8:case"end":return t.stop()}}),n)}))),St.apply(this,arguments)}function Ft(n,r,o,u,a){if(gt.isEmpty){if(null==n)throw new Error("没有找到元素 "+d+"，您可以尝试 delayToFocus 选项，等待元素 "+d+" 渲染完毕后进行聚焦。");if(null==o||null==u)throw new Error("至少需要包含两个可以聚焦的元素，如果元素需要等待渲染，您可以尝试 delayToFocus 选项。");var c=function(){return!!rt||wt},g=ht?function(t,n,e,r,o,i,u,a,c,l,f){return function(s){if(s.target!==c&&f()){var v=n(),d=v[0],m=v[1],g=e()[1],w=Math.max(0,d),k=t.length;if((null!=o?o:p)(s)){var x=w+1,b=r?Math.min(k-1,x):x;b%=k,null==u||u({e:s,prev:t[w],cur:t[b],prevI:w,curI:b}),null==l||l({e:s,prev:t[w],cur:t[b],prevI:w,curI:b}),m(b),g(w),y(t[b]),s.stopImmediatePropagation(),s.preventDefault()}else if((null!=i?i:h)(s)){var E=w-1,L=r?Math.max(0,E):E;L=(L+k)%k,null==a||a({e:s,prev:t[w],cur:t[L],prevI:w,curI:L}),null==l||l({e:s,prev:t[w],cur:t[L],prevI:w,curI:L}),m(L),g(w),y(t[L]),s.stopImmediatePropagation(),s.preventDefault()}}}}(r,(function(){return[yt,function(t){return yt=t}]}),(function(){return[,function(t){return mt=t}]}),pt,lt,vt,ft,dt,a,G,c):function(t,n,e,r,o,i,u){return function(a){var c=t[0],l=t.at(-1),f=a.target;f!==i&&u()&&(p(a)?(a.stopImmediatePropagation(),null==e||e({e:a}),f===l&&(a.preventDefault(),n||y(c)),f===o&&(a.preventDefault(),y(c))):h(a)&&(a.stopImmediatePropagation(),null==r||r({e:a}),f===c&&(a.preventDefault(),n||y(l)),f===o&&(a.preventDefault(),y(l))))}}(r,pt,ft,dt,n,a,c),w=k(S,F,tt,a,ot,n),x=w.exits,E=w.keyExits,L=w.clickExits,I=w.focusExits,j=w.hasClickExits,N=w.hasFocusExits,O=w.hasKeyExits,_=w.keyExits_wild,A=w.clickExits_wild,D=w.focusExits_wild,P=w.outListExits,T=_.map((function(t){return[f(null==t?void 0:t.node),At(t)]})),M=A.map((function(t){return[f(null==t?void 0:t.node),Ot(t)]})),B=D.map((function(t){return[f(null==t?void 0:t.node),_t(t)]}));!function(){gt.push(n,"focusin",R),gt.push(n,"focusout",U),n.contains(a)||null==a||(gt.push(a,"focus",J),gt.push(a,"blur",Q));gt.push(n,"keydown",(function(t){g(t),O&&function(t){if(t.target===a)return;if(at&&v(t))return;for(var n,e=i(E);!(n=e()).done;){if(st(t,n.value))break}}(t)})),ht&&gt.push(n,"click",H);gt.push(n,"mousedown",z),j&&gt.push(n,"click",nt);N&&gt.push(n,"focusin",ct);B.forEach((function(t){var n=t[0],e=t[1];gt.push(n,"focus",e)})),M.forEach((function(t){var n=t[0],e=t[1];gt.push(n,"click",e)})),T.forEach((function(t){var n=t[0],e=t[1];gt.push(n,"keydown",e)})),gt.push(a,"keydown",V),gt.addListeners()}(),Et=xt,Lt=jt,It=x;var K=!1}function R(t){var e=t.target;if(tt&&e===a)kt=!0;else if(tt&&!1===K&&!1===kt)m(a);else if(!1!==q&&ht&&!1===wt&&!1===K){var o,i=null!==(o=null==q?void 0:q({list:r,cover:a,root:n,last:r[yt],lastI:yt}))&&void 0!==o?o:-1===yt?r[0]:r[yt],u=f(i),c=r.findIndex((function(t){return t===u}));c>-1&&(mt=yt,yt=c,null==G||G({e:t,prev:r[mt],cur:r[yt],prevI:mt,curI:yt}),wt=!0),m(u)}}function U(t){setTimeout((function(){var e=l(),o=!n.contains(e),u=e===a;t.target===a&&o?kt=!1:(o&&!u&&function(t){for(var n,e=i(P);!(n=e()).done;){var r=n.value,o=r.on,u=r.target,a=r.delay,c=f(u);c?xt(t,o,c,a):jt(t,o,c,a);break}}(t),(u||o)&&(null==G||G({e:t,prev:r[yt],cur:null,prevI:yt,curI:-1}),wt=!1,u||(kt=!1)))}))}function z(t){K=!0,setTimeout((function(){K=!1})),(!ht||ht&&r.some((function(n){return n.contains(t.target)})))&&(wt=!0,tt&&(kt=!0))}function H(t){var n=t.target,e=r.findIndex((function(t){return t.contains(n)}));e>-1&&(mt=yt,yt=e,null==C||C({e:t,prev:r[mt],cur:r[yt],prevI:mt,curI:yt}),mt===yt&&!1!==wt||null==G||G({e:t,prev:r[mt],cur:r[yt],prevI:mt,curI:yt}))}function J(){kt=!0}function Q(){kt=!1}function V(t){if(t.target===a){if((null!=W?W:s)(t)&&!wt)return t.preventDefault(),wt=!0,null==X||X(t),y(r[yt=-1===yt?0:yt]),void(null==G||G({e:t,prev:null,cur:r[yt],prevI:null,curI:yt}));for(var n,e=i(it);!(n=e()).done;){var o=n.value,c=o.key,l=o.on,v=o.target,d=f(v);if(null!=c&&c(t,yt))return void h(t,l,d)}ut&&p(t)&&y(u)}function h(t,n,e){null==n||n(t),e&&y(e),Dt()}}function Z(t,n){var e=n.node,r=n.on,o=n.target,i=n.delay,u=f(e),a=f(o);return!(null!=u&&!u.contains(t.target)||null==u)&&(a?xt(t,r,a,i):jt(t,r,a,i),!0)}function nt(t){for(var n,e=i(L);!(n=e()).done;){if(Z(t,n.value))break}}function et(t,n){var e=n.node,r=n.on,o=n.target,i=n.delay,u=f(e),a=f(o);return(null==u||t.target===u)&&null!=u&&(a?xt(t,r,a,i):jt(t,r,a,i),!0)}function ct(t){for(var n,e=i(I);!(n=e()).done;){if(et(t,n.value))break}}function st(t,n){var e=n.key,r=n.node,o=n.target,i=n.on,u=n.delay,a=f(r),c=f(o);return(null==a||t.target===a)&&(null!=e&&e(t,yt)?(c?xt(t,i,c,u):jt(t,i,c,u),t.stopImmediatePropagation(),!0):void 0)}function xt(t,n,e,r){return bt.apply(this,arguments)}function bt(){return(bt=e(t().mark((function n(e,o,i,u){var c,l;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(l=function(){y(i),null==G||G({e:e,prev:r[yt],cur:i,prevI:yt,curI:-1}),i!==a&&Dt(),Ct()},wt){t.next=3;break}return t.abrupt("return");case 3:return wt=!1,e.preventDefault(),t.next=7,null==o?void 0:o(e);case 7:return u=null!==(c=u)&&void 0!==c?c:Y,t.next=10,b(u,l);case 10:t.sent&&l();case 12:case"end":return t.stop()}}),n)})))).apply(this,arguments)}function jt(t,n,e,r){return Nt.apply(this,arguments)}function Nt(){return(Nt=e(t().mark((function n(e,o,i,u){var c,l,f;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(wt){t.next=2;break}return t.abrupt("return");case 2:if(wt=!1,null===(c=e.preventDefault)||void 0===c||c.call(e),!1!==i){t.next=11;break}return t.next=7,null==o?void 0:o(e);case 7:return null==G||G({e:e,prev:r[yt],cur:null,prevI:yt,curI:-1}),Dt(),Ct(),t.abrupt("return");case 11:if(!tt){t.next=18;break}return t.next=14,null==o?void 0:o(e);case 14:null==G||G({e:e,prev:r[yt],cur:null,prevI:yt,curI:-1}),y(a),t.next=26;break;case 18:return f=function(){ot&&y(ot),null==G||G({e:e,prev:r[yt],cur:null,prevI:yt,curI:-1}),Dt(),Ct()},t.next=21,null==o?void 0:o(e);case 21:return u=null!==(l=u)&&void 0!==l?l:Y,t.next=24,b(u,f);case 24:t.sent&&f();case 26:case"end":return t.stop()}}),n)})))).apply(this,arguments)}function Ot(t){return function(n){Z(n,t)}}function _t(t){return function(n){et(n,t)}}function At(t){return function(n){n.target!==a&&(at&&v(n)||st(n,t))}}function Dt(){ut||$&&gt.removeListeners()}}function Ct(){if(xt.isEmpty){for(var t,n=function(){var n=t.value,e=n.node,r=n.on,o=n.key,i=n.type,u=n.target,a=n.delay,c=[].concat(i),l=["keydown","focus","click"],s=f(e);function v(t){null!=o&&o(t,yt)&&(t.preventDefault(),Tt(t,r,u,a),z&&xt.removeListeners())}function d(t){Tt(t,r,u,a),z&&xt.removeListeners()}c.forEach((function(t){if(s&&l.includes(t)){var n="keydown"===t?v:d;xt.push(s,t,n)}}))},e=i(et);!(t=e()).done;)n();xt.addListeners()}}}}));
//# sourceMappingURL=focus-bagel.umd.min.js.map
