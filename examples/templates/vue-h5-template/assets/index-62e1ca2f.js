import{q as e,r as o,e as t,c as a,s as l,n as s,m as n,v as r,b as c,t as i,i as u,T as v,x as d,y as p,p as f,z as m,g as y,j as h,P as x,H as w,I}from"./index-76f83ccc.js";import{L as b,l as z,d as S,e as k,r as g,W as O,M as C,w as B,a2 as A,k as L,v as P,h as T,f as j,a3 as X,V as Y,a4 as E,F as R,T as H}from"./index-a338e04e.js";function D(e){const o=b();o&&t(o.proxy,e)}let M=2e3;const[V,$]=a("loading"),F=Array(12).fill(null).map(((e,o)=>z("i",{class:$("line",String(o+1))},null))),N=z("svg",{class:$("circular"),viewBox:"25 25 50 50"},[z("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]);const q=c(S({name:V,props:{size:s,type:n("circular"),color:String,vertical:Boolean,textSize:s,textColor:String},setup(e,{slots:o}){const a=k((()=>t({color:e.color},l(e.size)))),s=()=>{const t="spinner"===e.type?F:N;return z("span",{class:$("spinner",e.type),style:a.value},[o.icon?o.icon():t])},n=()=>{var t;if(o.default)return z("span",{class:$("text"),style:{fontSize:r(e.textSize),color:null!=(t=e.textColor)?t:e.color}},[o.default()])};return()=>{const{type:o,vertical:t}=e;return z("div",{class:$([o,{vertical:t}]),"aria-live":"polite","aria-busy":!0},[s(),n()])}}})),K={show:Boolean,zIndex:s,overlay:i,duration:s,teleport:[String,Object],lockScroll:i,lazyRender:i,beforeClose:Function,overlayStyle:Object,overlayClass:u,transitionAppear:Boolean,closeOnClickOverlay:i};let W=0;const G="van-overflow-hidden";function J(e,o){const t=function(){const e=g(0),o=g(0),t=g(0),a=g(0),l=g(0),s=g(0),n=g(""),r=g(!0),c=()=>{t.value=0,a.value=0,l.value=0,s.value=0,n.value="",r.value=!0};return{move:c=>{const i=c.touches[0];var u,d;t.value=(i.clientX<0?0:i.clientX)-e.value,a.value=i.clientY-o.value,l.value=Math.abs(t.value),s.value=Math.abs(a.value),(!n.value||l.value<10&&s.value<10)&&(n.value=(u=l.value)>(d=s.value)?"horizontal":d>u?"vertical":""),r.value&&(l.value>v||s.value>v)&&(r.value=!1)},start:t=>{c(),e.value=t.touches[0].clientX,o.value=t.touches[0].clientY},reset:c,startX:e,startY:o,deltaX:t,deltaY:a,offsetX:l,offsetY:s,direction:n,isVertical:()=>"vertical"===n.value,isHorizontal:()=>"horizontal"===n.value,isTap:r}}(),a=o=>{t.move(o);const a=t.deltaY.value>0?"10":"01",l=p(o.target,e.value),{scrollHeight:s,offsetHeight:n,scrollTop:r}=l;let c="11";0===r?c=n>=s?"00":"01":r+n>=s&&(c="10"),"11"===c||!t.isVertical()||parseInt(c,2)&parseInt(a,2)||f(o,!0)},l=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",a,{passive:!1}),W||document.body.classList.add(G),W++},s=()=>{W&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",a),W--,W||document.body.classList.remove(G))},n=()=>o()&&s();d((()=>o()&&l())),O(n),C(n),B(o,(e=>{e?l():s()}))}function Q(e){const o=g(!1);return B(e,(e=>{e&&(o.value=e)}),{immediate:!0}),e=>()=>o.value?e():null}const U=()=>{var e;const{scopeId:o}=(null==(e=b())?void 0:e.vnode)||{};return o?{[o]:""}:null},[Z,_]=a("overlay");const ee=c(S({name:Z,props:{show:Boolean,zIndex:s,duration:s,className:u,lockScroll:i,lazyRender:i,customStyle:Object},setup(e,{slots:o}){const a=g(),l=Q((()=>e.show||!e.lazyRender))((()=>{var l;const s=t(y(e.zIndex),e.customStyle);return h(e.duration)&&(s.animationDuration=`${e.duration}s`),L(z("div",{ref:a,style:s,class:[_(),e.className]},[null==(l=o.default)?void 0:l.call(o)]),[[P,e.show]])}));return m("touchmove",(o=>{e.lockScroll&&f(o,!0)}),{target:a}),()=>z(A,{name:"van-fade",appear:!0},{default:l})}})),oe=t({},K,{round:Boolean,position:n("center"),closeIcon:n("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:n("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[te,ae]=a("popup");const le=c(S({name:te,inheritAttrs:!1,props:oe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(t,{emit:a,attrs:l,slots:s}){let n,r;const c=g(),i=g(),u=Q((()=>t.show||!t.lazyRender)),v=k((()=>{const e={zIndex:c.value};if(h(t.duration)){e["center"===t.position?"animationDuration":"transitionDuration"]=`${t.duration}s`}return e})),d=()=>{n||(n=!0,c.value=void 0!==t.zIndex?+t.zIndex:++M,a("open"))},p=()=>{n&&function(t,{args:a=[],done:l,canceled:s,error:n}){if(t){const r=t.apply(null,a);e(r)?r.then((e=>{e?l():s&&s()})).catch(n||o):r?l():s&&s()}else l()}(t.beforeClose,{done(){n=!1,a("close"),a("update:show",!1)}})},f=e=>{a("clickOverlay",e),t.closeOnClickOverlay&&p()},y=()=>{if(t.overlay)return z(ee,H({show:t.show,class:t.overlayClass,zIndex:c.value,duration:t.duration,customStyle:t.overlayStyle,role:t.closeOnClickOverlay?"button":void 0,tabindex:t.closeOnClickOverlay?0:void 0},U(),{onClick:f}),{default:s["overlay-content"]})},b=e=>{a("clickCloseIcon",e),p()},S=()=>{if(t.closeable)return z(I,{role:"button",tabindex:0,name:t.closeIcon,class:[ae("close-icon",t.closeIconPosition),w],classPrefix:t.iconPrefix,onClick:b},null)};let C;const V=()=>{C&&clearTimeout(C),C=setTimeout((()=>{a("opened")}))},$=()=>a("closed"),F=e=>a("keydown",e),N=u((()=>{var e;const{round:o,position:a,safeAreaInsetTop:n,safeAreaInsetBottom:r}=t;return L(z("div",H({ref:i,style:v.value,role:"dialog",tabindex:0,class:[ae({round:o,[a]:a}),{"van-safe-area-top":n,"van-safe-area-bottom":r}],onKeydown:F},l,U()),[null==(e=s.default)?void 0:e.call(s),S()]),[[P,t.show]])})),q=()=>{const{position:e,transition:o,transitionAppear:a}=t;return z(A,{name:o||("center"===e?"van-fade":`van-popup-slide-${e}`),appear:a,onAfterEnter:V,onAfterLeave:$},{default:N})};return B((()=>t.show),(e=>{e&&!n&&(d(),0===l.tabindex&&T((()=>{var e;null==(e=i.value)||e.focus()}))),!e&&n&&(n=!1,a("close"))})),D({popupRef:i}),J(i,(()=>t.show&&t.lockScroll)),m("popstate",(()=>{t.closeOnPopstate&&(p(),r=!1)})),j((()=>{t.show&&d()})),X((()=>{r&&(a("update:show",!0),r=!1)})),O((()=>{t.show&&t.teleport&&(p(),r=!0)})),Y(x,(()=>t.show)),()=>t.teleport?z(E,{to:t.teleport},{default:()=>[y(),q()]}):z(R,null,[y(),q()])}}));export{q as L,le as P,D as u};
