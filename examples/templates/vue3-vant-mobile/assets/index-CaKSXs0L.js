import{c as H,e as E,i as Se,a as ne,d as B,m as $,b as K,n as R,r as x,u as Pe,f as T,g as ge,h as he,w as _e,j as be,k as d,p as ke,H as le,t as pe,l as U,o as Ee,q as Ie,s as L,v as ae,x as ie,y as De,z as Me,B as He,A as q,C as Ce,D as J,E as Be,F as Ne,G as $e,I as Q,J as Ae,K as W,L as se,M as ue,N as X,O as A,P as O,Q as Z,R as ce,S as Re,T as Ue,U as Le,V as Fe}from"./index-Ctp_OdSt.js";import{C as Ke}from"./index-DyT-QBQl.js";import{C as ze}from"./index-C0Ypck_d.js";import{L as Oe}from"./index-D1XoyNzR.js";import{b as re}from"./route-block-B_A1xBdJ.js";const[Ye,y,de]=H("picker"),Te=e=>e.find(o=>!o.disabled)||e[0];function Ge(e,o){const n=e[0];if(n){if(Array.isArray(n))return"multiple";if(o.children in n)return"cascade"}return"default"}function F(e,o){o=ne(o,0,e.length);for(let n=o;n<e.length;n++)if(!e[n].disabled)return n;for(let n=o-1;n>=0;n--)if(!e[n].disabled)return n;return 0}const me=(e,o,n)=>o!==void 0&&!!e.find(u=>u[n.value]===o);function oe(e,o,n){const u=e.findIndex(f=>f[n.value]===o),a=F(e,u);return e[a]}function je(e,o,n){const u=[];let a={[o.children]:e},f=0;for(;a&&a[o.children];){const r=a[o.children],h=n.value[f];if(a=Se(h)?oe(r,h,o):void 0,!a&&r.length){const m=Te(r)[o.value];a=oe(r,m,o)}f++,u.push(r)}return u}function qe(e){const{transform:o}=window.getComputedStyle(e),n=o.slice(7,o.length-1).split(", ")[5];return Number(n)}function Je(e){return E({text:"text",value:"value",children:"children"},e)}const ve=200,fe=300,Qe=15,[we,ee]=H("picker-column"),ye=Symbol(we);var We=B({name:we,props:{value:R,fields:$(Object),options:K(),readonly:Boolean,allowHtml:Boolean,optionHeight:$(Number),swipeDuration:$(R),visibleOptionNum:$(R)},emits:["change","clickOption","scrollInto"],setup(e,{emit:o,slots:n}){let u,a,f,r,h;const m=x(),g=x(),v=x(0),s=x(0),k=Pe(),p=()=>e.options.length,S=()=>e.optionHeight*(+e.visibleOptionNum-1)/2,w=c=>{let t=F(e.options,c);const l=-t*e.optionHeight,i=()=>{t>p()-1&&(t=F(e.options,c));const V=e.options[t][e.fields.value];V!==e.value&&o("change",V)};u&&l!==v.value?h=i:i(),v.value=l},C=()=>e.readonly||!e.options.length,b=c=>{u||C()||(h=null,s.value=ve,w(c),o("clickOption",e.options[c]))},P=c=>ne(Math.round(-c/e.optionHeight),0,p()-1),N=T(()=>P(v.value)),Y=(c,t)=>{const l=Math.abs(c/t);c=v.value+l/.003*(c<0?-1:1);const i=P(c);s.value=+e.swipeDuration,w(i)},I=()=>{u=!1,s.value=0,h&&(h(),h=null)},G=c=>{if(!C()){if(k.start(c),u){const t=qe(g.value);v.value=Math.min(0,t-S())}s.value=0,a=v.value,f=Date.now(),r=a,h=null}},j=c=>{if(C())return;k.move(c),k.isVertical()&&(u=!0,ke(c,!0));const t=ne(a+k.deltaY.value,-(p()*e.optionHeight),e.optionHeight),l=P(t);l!==N.value&&o("scrollInto",e.options[l]),v.value=t;const i=Date.now();i-f>fe&&(f=i,r=t)},D=()=>{if(C())return;const c=v.value-r,t=Date.now()-f;if(t<fe&&Math.abs(c)>Qe){Y(c,t);return}const i=P(v.value);s.value=ve,w(i),setTimeout(()=>{u=!1},0)},_=()=>{const c={height:"".concat(e.optionHeight,"px")};return e.options.map((t,l)=>{const i=t[e.fields.text],{disabled:V}=t,M=t[e.fields.value],xe={role:"button",style:c,tabindex:V?-1:0,class:[ee("item",{disabled:V,selected:M===e.value}),t.className],onClick:()=>b(l)},Ve={class:"van-ellipsis",[e.allowHtml?"innerHTML":"textContent"]:i};return d("li",xe,[n.option?n.option(t,l):d("div",Ve,null)])})};return ge(ye),he({stopMomentum:I}),_e(()=>{const c=u?Math.floor(-v.value/e.optionHeight):e.options.findIndex(i=>i[e.fields.value]===e.value),t=F(e.options,c),l=-t*e.optionHeight;u&&t<c&&I(),v.value=l}),be("touchmove",j,{target:m}),()=>d("div",{ref:m,class:ee(),onTouchstartPassive:G,onTouchend:D,onTouchcancel:D},[d("ul",{ref:g,style:{transform:"translate3d(0, ".concat(v.value+S(),"px, 0)"),transitionDuration:"".concat(s.value,"ms"),transitionProperty:s.value?"all":"none"},class:ee("wrapper"),onTransitionend:I},[_()])])}});const[Xe]=H("picker-toolbar"),z={title:String,cancelButtonText:String,confirmButtonText:String},Ze=["cancel","confirm","title","toolbar"],et=Object.keys(z);var tt=B({name:Xe,props:z,emits:["confirm","cancel"],setup(e,{emit:o,slots:n}){const u=()=>{if(n.title)return n.title();if(e.title)return d("div",{class:[y("title"),"van-ellipsis"]},[e.title])},a=()=>o("cancel"),f=()=>o("confirm"),r=()=>{var m;const g=(m=e.cancelButtonText)!=null?m:de("cancel");if(!(!n.cancel&&!g))return d("button",{type:"button",class:[y("cancel"),le],onClick:a},[n.cancel?n.cancel():g])},h=()=>{var m;const g=(m=e.confirmButtonText)!=null?m:de("confirm");if(!(!n.confirm&&!g))return d("button",{type:"button",class:[y("confirm"),le],onClick:f},[n.confirm?n.confirm():g])};return()=>d("div",{class:y("toolbar")},[n.toolbar?n.toolbar():[r(),u(),h()]])}});const[nt,kt]=H("picker-group"),ot=Symbol(nt);E({tabs:K(),activeTab:U(0),nextStepText:String,showToolbar:pe},z);const lt=E({loading:Boolean,readonly:Boolean,allowHtml:Boolean,optionHeight:U(44),showToolbar:pe,swipeDuration:U(1e3),visibleOptionNum:U(6)},z),at=E({},lt,{columns:K(),modelValue:K(),toolbarPosition:Me("top"),columnsFieldNames:Object});var it=B({name:Ye,props:at,emits:["confirm","cancel","change","scrollInto","clickOption","update:modelValue"],setup(e,{emit:o,slots:n}){const u=x(),a=x(e.modelValue.slice(0)),{parent:f}=ge(ot),{children:r,linkChildren:h}=Ee(ye);h();const m=T(()=>Je(e.columnsFieldNames)),g=T(()=>Ie(e.optionHeight)),v=T(()=>Ge(e.columns,m.value)),s=T(()=>{const{columns:t}=e;switch(v.value){case"multiple":return t;case"cascade":return je(t,m.value,a);default:return[t]}}),k=T(()=>s.value.some(t=>t.length)),p=T(()=>s.value.map((t,l)=>oe(t,a.value[l],m.value))),S=T(()=>s.value.map((t,l)=>t.findIndex(i=>i[m.value.value]===a.value[l]))),w=(t,l)=>{if(a.value[t]!==l){const i=a.value.slice(0);i[t]=l,a.value=i}},C=()=>({selectedValues:a.value.slice(0),selectedOptions:p.value,selectedIndexes:S.value}),b=(t,l)=>{w(l,t),v.value==="cascade"&&a.value.forEach((i,V)=>{const M=s.value[V];me(M,i,m.value)||w(V,M.length?M[0][m.value.value]:void 0)}),ae(()=>{o("change",E({columnIndex:l},C()))})},P=(t,l)=>{const i={columnIndex:l,currentOption:t};o("clickOption",E(C(),i)),o("scrollInto",i)},N=()=>{r.forEach(l=>l.stopMomentum());const t=C();return ae(()=>{o("confirm",t)}),t},Y=()=>o("cancel",C()),I=()=>s.value.map((t,l)=>d(We,{value:a.value[l],fields:m.value,options:t,readonly:e.readonly,allowHtml:e.allowHtml,optionHeight:g.value,swipeDuration:e.swipeDuration,visibleOptionNum:e.visibleOptionNum,onChange:i=>b(i,l),onClickOption:i=>P(i,l),onScrollInto:i=>{o("scrollInto",{currentOption:i,columnIndex:l})}},{option:n.option})),G=t=>{if(k.value){const l={height:"".concat(g.value,"px")},i={backgroundSize:"100% ".concat((t-g.value)/2,"px")};return[d("div",{class:y("mask"),style:i},null),d("div",{class:[He,y("frame")],style:l},null)]}},j=()=>{const t=g.value*+e.visibleOptionNum,l={height:"".concat(t,"px")};return!e.loading&&!k.value&&n.empty?n.empty():d("div",{ref:u,class:y("columns"),style:l},[I(),G(t)])},D=()=>{if(e.showToolbar&&!f)return d(tt,De(ie(e,et),{onConfirm:N,onCancel:Y}),ie(n,Ze))};L(s,t=>{t.forEach((l,i)=>{l.length&&!me(l,a.value[i],m.value)&&w(i,Te(l)[m.value.value])})},{immediate:!0});let _;return L(()=>e.modelValue,t=>{!q(t,a.value)&&!q(t,_)&&(a.value=t.slice(0),_=t.slice(0))},{deep:!0}),L(a,t=>{q(t,e.modelValue)||(_=t.slice(0),o("update:modelValue",_))},{immediate:!0}),be("touchmove",ke,{target:u}),he({confirm:N,getSelectedOptions:()=>p.value}),()=>{var t,l;return d("div",{class:y()},[e.toolbarPosition==="top"?D():null,e.loading?d(Oe,{class:y("loading")},null):null,(t=n["columns-top"])==null?void 0:t.call(n),j(),(l=n["columns-bottom"])==null?void 0:l.call(n),e.toolbarPosition==="bottom"?D():null])}}});const st=Ce(it),[ut,te]=H("switch"),ct={size:R,loading:Boolean,disabled:Boolean,modelValue:J,activeColor:String,inactiveColor:String,activeValue:{type:J,default:!0},inactiveValue:{type:J,default:!1}};var rt=B({name:ut,props:ct,emits:["change","update:modelValue"],setup(e,{emit:o,slots:n}){const u=()=>e.modelValue===e.activeValue,a=()=>{if(!e.disabled&&!e.loading){const r=u()?e.inactiveValue:e.activeValue;o("update:modelValue",r),o("change",r)}},f=()=>{if(e.loading){const r=u()?e.activeColor:e.inactiveColor;return d(Oe,{class:te("loading"),color:r},null)}if(n.node)return n.node()};return Be(()=>e.modelValue),()=>{var r;const{size:h,loading:m,disabled:g,activeColor:v,inactiveColor:s}=e,k=u(),p={fontSize:Ne(h),backgroundColor:k?v:s};return d("div",{role:"switch",class:te({on:k,loading:m,disabled:g}),style:p,tabindex:g?void 0:0,"aria-checked":k,onClick:a},[d("div",{class:te("node")},[f()]),(r=n.background)==null?void 0:r.call(n)])}}});const dt=Ce(rt),mt=B({__name:"index",setup(e){const o=$e(),n=x(Q.value);L(()=>Q.value,v=>{n.value=v},{immediate:!0});function u(){Fe(),o.switchMode(Q.value?"dark":"light")}const{t:a}=Ae(),f=x(!1),r=x([W.value]),h=T(()=>se.find(v=>v.value===W.value).text);function m(v){W.value=v.selectedOptions[0].value,f.value=!1}const g=T(()=>[{title:a("menus.mockGuide"),route:"mock"},{title:a("menus.echartsDemo"),route:"charts"},{title:a("menus.unocssExample"),route:"unocss"},{title:a("menus.persistPiniaState"),route:"counter"},{title:a("menus.keepAlive"),route:"keepalive"},{title:a("menus.404Demo"),route:"unknown"}]);return(v,s)=>{const k=dt,p=ze,S=Ke,w=st,C=Le;return X(),ue(ce,null,[d(S,{title:O(a)("menus.basicSettings"),border:!1,inset:!0},{default:A(()=>[d(p,{center:"",title:O(a)("menus.darkMode")},{"right-icon":A(()=>[d(k,{modelValue:O(n),"onUpdate:modelValue":s[0]||(s[0]=b=>Z(n)?n.value=b:null),size:"20px","aria-label":"on/off Dark Mode",onClick:s[1]||(s[1]=b=>u())},null,8,["modelValue"])]),_:1},8,["title"]),d(p,{"is-link":"",title:O(a)("menus.language"),value:O(h),onClick:s[2]||(s[2]=b=>f.value=!0)},null,8,["title","value"])]),_:1},8,["title"]),d(S,{title:O(a)("menus.exampleComponents"),border:!1,inset:!0},{default:A(()=>[(X(!0),ue(ce,null,Re(O(g),b=>(X(),Ue(p,{key:b.route,title:b.title,to:b.route,"is-link":""},null,8,["title","to"]))),128))]),_:1},8,["title"]),d(C,{show:O(f),"onUpdate:show":s[5]||(s[5]=b=>Z(f)?f.value=b:null),position:"bottom"},{default:A(()=>[d(w,{modelValue:O(r),"onUpdate:modelValue":s[3]||(s[3]=b=>Z(r)?r.value=b:null),columns:O(se),onConfirm:m,onCancel:s[4]||(s[4]=b=>f.value=!1)},null,8,["modelValue","columns"])]),_:1},8,["show"])],64)}}});typeof re=="function"&&re(mt);export{mt as default};
