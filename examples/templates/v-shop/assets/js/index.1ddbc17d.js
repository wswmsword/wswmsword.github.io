import{_ as O}from"./index.6012130b.js";import{e as D,z as b,h as R,i as r,r as m,o as u,a as g,g as d,w as y,b as e,V as N,F as B,l as k,K as Y,k as E,G as U,H as $,y as q,j as J,A as Q,B as V,f as L,E as W,C as A,D as f}from"./vendor.1aafb642.js";import{A as M}from"./index.ccd2f348.js";import{_ as X}from"./index.332e104b.js";import{_ as F}from"./index.ce6ac14e.js";const Z=a=>(U("data-v-bdf2b3fe"),a=a(),$(),a),ee=Z(()=>e("div",{class:"exchange-header van-hairline--bottom"},"兑换优惠口令",-1)),te={class:"exchange-body"},se={name:"ExchangeCoupon"},oe=D({...se,props:{show:{type:Boolean}},emits:["update:show","success"],setup(a,{expose:T,emit:n}){const s={width:"80%","border-radius":"4px"},c=b(""),p=R(()=>r(c).length);function w(){if(!r(c)){k("请输入口令");return}const _={pwd:r(c)};Y({forbidClick:!0,message:"加载中...",duration:0}),M.discountsFetch(_).then(()=>{E(),k({message:"兑换成功",duration:2e3}),n("success")}).catch(l=>{console.error(l),E(),Number(l.code)===700?k({message:"口令无效",duration:2e3}):k({message:l.msg,duration:2e3})})}function v(){h(!0)}function x(){h(!1)}function h(_){n("update:show",_)}return T({open:v,close:x,updateShow:h}),(_,l)=>{const S=m("van-icon"),C=m("van-field"),I=m("van-popup"),i=X;return u(),g(B,null,[d(I,{show:a.show,position:"center",style:s,"onUpdate:show":h},{default:y(()=>[e("div",{class:"exchange-popup-close",onClick:x},[d(S,{class:"exchange-popup-close-icon",name:"cross"})]),ee,e("div",te,[d(C,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=o=>c.value=o),clearable:"",border:!1,placeholder:"请输入口令（例如v-shop，2022）",class:"exchange-field",type:"text"},null,8,["modelValue"]),e("div",{class:N(["van-haptics-feedback","exchange-btn",p.value?"active":"gray"]),type:"primary",onClick:w}," 兑换 ",2)])]),_:1},8,["show"]),d(i,{size:"medium",text:"兑换优惠口令",onClickBtn:v})],64)}}});const ae=F(oe,[["__scopeId","data-v-bdf2b3fe"]]),ne="/examples/templates/v-shop/assets/png/coupon.8518b7e7.png",ce=a=>(U("data-v-2baed244"),a=a(),$(),a),ie={class:"container"},le={class:"tab-list"},ue={class:"list-item-hd"},de={class:"list-item-money"},pe={class:"list-item-price"},_e=ce(()=>e("span",{class:"list-item-price-unit"},"元",-1)),re={class:"list-item-desc van-ellipsis"},me={class:"list-item-bd"},ve={class:"list-item-bd-inner"},he={class:"list-item-bd-title van-ellipsis"},fe={class:"list-item-bd-txt"},be=D({__name:"index",setup(a){const T=q();J(()=>{v()});const n=b([{name:"未使用",status:0,customClass:"red",buttonTxt:"立即使用"},{name:"已使用",status:3,customClass:"gray",buttonTxt:"已使用"},{name:"已过期",status:2,customClass:"gray",buttonTxt:"已过期"}]),s=b(0),c=b([]),p=b(!0),w=Q({emptyText:"暂无优惠券",emptyImage:ne});function v(){p.value=!0,M.discountsMy({status:r(n)[r(s)].status}).then(i=>{c.value=i.data||[]}).finally(()=>{p.value=!1})}function x(i){return i.slice(0,10)}function h(i){let o="";return i===0?o="满任意金额可用":o=`满${i}元可用`,o}function _(){T.replace({path:"/home"})}function l(){r(p)||v()}function S(){_()}const C=b(!1);function I(){C.value=!1,r(s)===0&&v()}return(i,o)=>{const z=m("van-tab"),H=m("van-tabs"),G=m("van-button"),P=m("van-empty"),j=O;return u(),g("div",ie,[e("div",le,[d(H,{active:s.value,"onUpdate:active":o[0]||(o[0]=t=>s.value=t),onClickTab:l},{default:y(()=>[(u(!0),g(B,null,V(n.value,(t,K)=>(u(),L(z,{key:K,title:t.name},null,8,["title"]))),128))]),_:1},8,["active"])]),d(j,{loading:p.value,"onUpdate:loading":o[1]||(o[1]=t=>p.value=t),hasData:!!c.value.length},{empty:y(()=>[d(P,{class:"empty",image:w.emptyImage,description:w.emptyText},{default:y(()=>[s.value===0?(u(),L(G,{key:0,class:"empty-btn",round:"",plain:"",type:"primary",onClick:_},{default:y(()=>[W("进店逛逛")]),_:1})):A("",!0)]),_:1},8,["image","description"])]),default:y(()=>[e("div",{class:N(["list",[n.value[s.value]?n.value[s.value].customClass:""]])},[(u(!0),g(B,null,V(c.value,t=>(u(),g("div",{key:t.id,class:"list-item"},[e("div",ue,[e("div",de,[e("span",pe,f(t.money),1),_e]),e("div",re,f(h(t.moneyHreshold)),1)]),e("div",me,[e("div",ve,[e("div",he,f(t.name),1),e("div",fe,f(x(t.dateStart))+"至"+f(x(t.dateEnd)),1)]),s.value===0?(u(),g("div",{key:0,class:"list-item-bd-action",onClick:S},f(n.value[s.value]?n.value[s.value].buttonTxt:""),1)):A("",!0)])]))),128))],2)]),_:1},8,["loading","hasData"]),d(ae,{show:C.value,"onUpdate:show":o[2]||(o[2]=t=>C.value=t),onSuccess:I},null,8,["show"])])}}});const ke=F(be,[["__scopeId","data-v-2baed244"]]);export{ke as default};
