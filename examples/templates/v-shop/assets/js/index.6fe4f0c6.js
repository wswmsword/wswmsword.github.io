import{_ as ee}from"./index.f89d891c.js";import{_ as te}from"./index.vue_vue_type_script_lang.c37d2b68.js";import{e as se,j as oe,i as t,z as I,h as x,r as g,o as n,a as i,g as d,w as p,b as o,F as f,D as m,C as S,l as N,I as ae,G as ne,H as le,N as E,B as ce,E as _,f as P,J as ie,K as re,k as de}from"./vendor.1aafb642.js";import{d as A}from"./format.df5cff0c.js";import{A as T}from"./index.ed12fca4.js";import{u as ue}from"./order.1a54acc5.js";import{u as pe}from"./usePage.0ebad3d8.js";import{_ as me}from"./index.ce6ac14e.js";import"./is.697638d0.js";import"./index.a51135f2.js";const _e="/examples/templates/v-shop/assets/png/cart.70a0f26e.png",he="/examples/templates/v-shop/assets/mp4/shopping-cart.dc3dc49c.mp4",u=y=>(ne("data-v-e94a2c7d"),y=y(),le(),y),ve={class:"container"},ge={key:0,class:"goods"},fe={class:"goods-header van-hairline--bottom"},ye={class:"goods-header-hd"},be=["src"],ke=u(()=>o("span",null,"购物车",-1)),Ce={class:"list"},xe={class:"list-item-selected"},Se={class:"list-item-content"},Te={class:"list-item-title"},Ve={key:0,style:{color:"var(--color-text-4)"}},Ie={class:"list-item-desc"},Ne={key:0,class:"list-item-prop"},Ee={class:"list-item-bottom"},Le={class:"list-item-price"},we=u(()=>o("span",{class:"list-item-price-symbol"},"¥",-1)),Pe={class:"list-item-price-integer"},Ae=u(()=>o("div",{class:"empty-title"},"购物车快饿瘪了 T.T",-1)),Ge=u(()=>o("div",{class:"empty-txt"},"快给我挑点宝贝",-1)),He=u(()=>o("div",{class:"empty-title"},"登录后才能看到您的购物车",-1)),Be={class:"submit-bar-wrap"},De={key:0,class:"submit-bar"},Fe=u(()=>o("div",{class:"submit-bar-hd"},null,-1)),Me={class:"submit-bar-hd"},Re=u(()=>o("span",{class:"submit-bar-total"},"合计：",-1)),Ue={class:"submit-bar-price"},je=u(()=>o("span",{class:"submit-bar-price-symbol"},"¥",-1)),Oe={class:"submit-bar-price-integer"},$e={name:"Cart"},ze=se({...$e,setup(y){oe(()=>{t(L)?O():h.value=!1});const G=ue(),{hasLogin:L,goHome:H,goLogin:B}=pe(),b=I(1);function D(){b.value=t(b)===1?2:1}const l=I([]),h=I(!0),F=_e,M=he;function R(s){return s.map(e=>e.optionValueName).join(",")}const r=x(()=>t(l).filter(s=>s.selected)),U=x(()=>t(r).reduce((s,e)=>E.plus(s,e.number),0)),j=x(()=>t(r).reduce((s,e)=>E.plus(s,E.times(e.price,e.number)),0)),w=x({get(){return t(r).length===t(l).length},set(s){t(l).forEach(e=>{e.selected=s})}});function O(){h.value=!0,T.shoppingCartInfo().then(s=>{var e;l.value=((e=s.data)==null?void 0:e.items)??[]}).finally(()=>{h.value=!1})}const $=ie((s,e)=>{const{key:c}=t(l)[e];J(e,{key:c,number:s})},1e3);function z(){if(!t(r).length){N({message:"您还没有选择商品哦",duration:1500});return}const s=t(r).length===t(l).length?"empty":"remove",e=s==="empty"?"确定要清空购物车吗？":`确定要删除这${t(r).length}个商品吗？`;ae({message:e}).then(()=>{s==="empty"?K():Y()}).catch(c=>{console.log(c)})}function J(s,{key:e,number:c}){re({forbidClick:!0,message:"修改中...",duration:0}),T.shoppingCartModifyNumber({number:c,key:e}).then(v=>{var k;de(),l.value=((k=v.data)==null?void 0:k.items)??[]}).catch(v=>{console.log(v)})}function K(){T.shoppingCartEmpty().then(()=>{l.value=[]}).catch(s=>{console.log(s)})}function Y(){const s=t(r).map(e=>e.key).join(",");T.shoppingCartRemove({key:s}).then(e=>{var c;l.value=((c=e.data)==null?void 0:c.items)??[]}).catch(e=>{console.log(e)})}function q(){if(!t(r).length){N({message:"您还没有选择商品哦",duration:1500});return}if(t(r).some(s=>s.status===1)){N({message:"请删除掉失效商品",duration:1500});return}G.setTradeGoods({origin:"cart",list:t(r)})}return(s,e)=>{const c=g("van-checkbox"),v=g("van-image"),k=g("van-stepper"),C=g("van-button"),Q=g("van-empty"),W=te,X=ee;return n(),i("div",ve,[d(W,{loading:h.value,"onUpdate:loading":e[0]||(e[0]=a=>h.value=a)},{default:p(()=>[l.value.length?(n(),i("div",ge,[o("div",fe,[o("div",ye,[o("video",{class:"goods-header-cart",src:t(M),width:"40",height:"40",autoplay:"",muted:"",loop:"",type:"video/mp4"},null,8,be),ke]),o("div",{class:"goods-header-bd",onClick:D},m(b.value===1?"编辑":"完成"),1)]),o("div",Ce,[(n(!0),i(f,null,ce(l.value,(a,Z)=>(n(),i("div",{key:a.key,class:"list-item"},[o("div",xe,[d(c,{modelValue:a.selected,"onUpdate:modelValue":V=>a.selected=V},null,8,["modelValue","onUpdate:modelValue"])]),d(v,{fit:"contain",class:"list-item-pic",src:a.pic},null,8,["src"]),o("div",Se,[o("div",Te,[a.status===1?(n(),i("span",Ve,"【失效】")):S("",!0),_(" "+m(a.name),1)]),o("div",Ie,[a.sku&&a.sku.length?(n(),i("div",Ne,m(R(a.sku)),1)):S("",!0)]),o("div",Ee,[o("div",Le,[we,o("span",Pe,m(t(A)(a.price)),1)]),a.status===0?(n(),P(k,{key:0,"model-value":a.number,"async-change":"",class:"sku-num-stepper",onChange:V=>t($)(V,Z)},null,8,["model-value","onChange"])):S("",!0)])])]))),128))])])):(n(),P(Q,{key:1,class:"empty",image:t(F)},{default:p(()=>[t(L)?(n(),i(f,{key:0},[Ae,Ge,d(C,{class:"empty-btn",round:"",plain:"",type:"primary",onClick:t(H)},{default:p(()=>[_("去逛逛")]),_:1},8,["onClick"])],64)):(n(),i(f,{key:1},[He,d(C,{class:"empty-btn",type:"primary",round:"",onClick:t(B)},{default:p(()=>[_("去登录")]),_:1},8,["onClick"])],64))]),_:1},8,["image"]))]),_:1},8,["loading"]),o("div",Be,[l.value.length?(n(),i("div",De,[d(c,{modelValue:w.value,"onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a)},{default:p(()=>[_("全选")]),_:1},8,["modelValue"]),b.value===2?(n(),i(f,{key:0},[Fe,d(C,{class:"submit-bar-button",round:"",plain:"",onClick:z},{default:p(()=>[_("删除")]),_:1})],64)):(n(),i(f,{key:1},[o("div",Me,[Re,o("div",Ue,[je,o("span",Oe,m(t(A)(j.value)),1)])]),d(C,{class:"submit-bar-button",round:"",type:"primary",onClick:q},{default:p(()=>[_("去结算("+m(U.value)+")",1)]),_:1})],64))])):S("",!0)]),d(X)])}}});const st=me(ze,[["__scopeId","data-v-e94a2c7d"]]);export{st as default};
