<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="google-site-verification" content="" />
  <meta name="referrer" content="unsafe-url">
  
  <title>阅读《网络是怎样连接的》记录</title>
  <meta name="author" content="wsWmsword">
  <meta name="description" content="Pain is temporary Pride is forever">
  
  
  <meta property="og:title" content="阅读《网络是怎样连接的》记录"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:site_name" content="Strawberry Fields"/>
  <link href="/apple-touch-icon-precomposed.png" sizes="180x180" rel="apple-touch-icon-precomposed">
  <link rel="alternate" href="/atom.xml" title="Strawberry Fields" type="application/atom+xml">
  <link rel="stylesheet" href="/css/m.min.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>

<meta name="generator" content="Hexo 5.4.2"></head>

<body>
  <a id="top"></a>
  <div id="main">
    <div class="main-ctnr">
      <div class="behind">
  <a href="/" class="back black-color">
    <svg class="i-close" viewBox="0 0 32 32" width="22" height="22" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
        <path d="M2 30 L30 2 M30 30 L2 2"></path>
    </svg>
  </a>
  
    <div class="description">
      &nbsp;郁郁青青 长过千寻
    </div>
    
</div>


  <article class="standard post">
    <div class="title">
      
  
    <h1 class="page-title center">
        阅读《网络是怎样连接的》记录
    </h1>
  


    </div>
    <div class="meta center">
      <time datetime="2022-09-09T14:32:15.000Z" itemprop="datePublished">
  <svg class="i-calendar" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
    <path d="M2 6 L2 30 30 30 30 6 Z M2 15 L30 15 M7 3 L7 9 M13 3 L13 9 M19 3 L19 9 M25 3 L25 9"></path>
  </svg>
  &nbsp;
  2022-09-09
</time>


    
    &nbsp;
    <svg class="i-tag" viewBox="0 0 32 32" width="16" height="16" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
      <circle cx="24" cy="8" r="2"></circle>
      <path d="M2 18 L18 2 30 2 30 14 14 30 Z"></path>
    </svg>
    &nbsp;
    <a href="/categories/笔记本/">笔记本</a>





    </div>
    <hr>
    
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%92%8C%E6%96%AD%E5%BC%80"><span class="toc-text">连接和断开</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#keep-alive"><span class="toc-text">keep-alive</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%AD%98"><span class="toc-text">缓存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8A%B6%E6%80%81%E7%A0%81"><span class="toc-text">状态码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%A8%E5%9F%9F"><span class="toc-text">跨域</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS%EF%BC%88Domain-Name-System%EF%BC%89"><span class="toc-text">DNS（Domain Name System）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTPS"><span class="toc-text">HTTPS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%94%B6%E5%8F%91"><span class="toc-text">数据收发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP-%E6%96%B9%E6%B3%95"><span class="toc-text">HTTP 方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SEO"><span class="toc-text">SEO</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8"><span class="toc-text">安全</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-text">问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83"><span class="toc-text">其它</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E7%94%A8"><span class="toc-text">引用</span></a></li></ol></li></ol>
    
    <div class="picture-container">
      
    </div>
    <h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>网络知识是计算机的基础，是作为计算机从业者的基本素养。下面的内容是我阅读《网络是怎样连接的》的记录合了，也结网络进行了一些扩展。</p>
<h2 id="连接和断开"><a href="#连接和断开" class="headerlink" title="连接和断开"></a>连接和断开</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/67013338/answer/1032098712">为什么TCP4次挥手时等待为2MSL？ - 知乎用户的回答 - 知乎</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaofei0859/article/details/6044694/">什么是2MSL</a></li>
</ul>
<h2 id="keep-alive"><a href="#keep-alive" class="headerlink" title="keep-alive"></a>keep-alive</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.pudn.com/news/628f8293bf399b7f351e3286.html">HTTP协议头部与Keep-Alive模式详解</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/388270712">HTTP保持长连接的操作</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/0201zcr/p/4694945.html">HTTP长连接和短连接</a></li>
</ul>
<h2 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h2><p>强制缓存：直接从客户端本地获取，不向服务端请求，即使断网也能获取；这种情况下，状态码 200，在浏览器开发者工具可以看到<code>Status Code: 200  (from memory cache)</code>或者<code>Status Code: 200  (from disk cache)</code>。</p>
<p>协商缓存：客户端会向服务端请求，但不从服务端直接获取资源，而是先询问自己是否能使用缓存，“我的缓存过期了吗”，服务端会告诉客户端结果，如果没过期，客户端将直接使用缓存，如果过期了，服务端会把最新的资源送给客户端，这个过程叫协商；这种情况，状态码 304，<code>Status Code: 304</code>。</p>
<p>和强制缓存相关的字段：Expires 和 Cache-Control；其中 Cache-Control 的值可以有很多组合，但是当值包含<code>max-age=t1</code>的时候，就会在 t1 时间内不向服务端请求，而直接取缓存，t1 时间内走的是强制缓存。</p>
<p>和协商缓存相关的字段：ETag/If-None-Match 和 Last-Modified/If-Modified-Since。</p>
<p>Expires：</p>
<ul>
<li>HTTP1.0 字段，如果设置了 Cache-Control 的 max-age 字段，Expires 会被忽略；</li>
<li>设置具体的时间值（首次请求时服务端返回）作为缓存的过期时间，例如“<code>expires: Tue, 20 Sep 2022 00:47:28 GMT</code>”；</li>
<li>过期时间由服务端确定，而客户端时间并非一致（时区、用户主动调节时间），缓存无法预期，只要客户端时间以任何理由超过 expires，缓存将失效。</li>
</ul>
<p>关于用户主动调时，因为技术透明，用户介入主动受害（缓存失效）；关于时区，技术结果，用户被动受害（缓存失效）。</p>
<p>Cache-Control：</p>
<ul>
<li>HTTP1.1 字段，设置相对时间控制缓存过期时间；</li>
<li>public（任何地方缓存，客户端或者代理）；</li>
<li>private（只允许客户端缓存）；</li>
<li>no-cache（协商缓存，使用缓存前问服务端自己的缓存过期了没）；</li>
<li>no-store（禁用缓存，机密文件不想客户端缓存）</li>
<li>max-age=（单位是秒）, s-maxage=（优先级高于 max-age= 和 expires，仅适用共享缓存）；</li>
<li>max-stale[=]（表示客户端愿意接受已过期资源，但是不能超过给定时间）；</li>
<li><code>cache-control: max-age=315360000</code>表示过期时间（新鲜度）一年，一年内内，可以绕过请求服务端，直接使用缓存；</li>
<li><code>Cache-Control: no-cache</code>——使用缓存之前要请求服务端，验证缓存是否仍然有效，不能绕过服务端，另外<code>Cache-Control: max-age=0, must-revalidate</code>相当于 no-cache。</li>
</ul>
<blockquote>
<p>If a response includes both an Expires header and a max-age directive, the max-age directive overrides the Expires header, even if the Expires header is more restrictive — <a target="_blank" rel="noopener" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.9.3">RFC2016</a>，同时有 max-age 和 expires，expires 将被覆盖</p>
</blockquote>
<p>Last-Modified / If-Modified-Since：</p>
<ul>
<li>第一次请求服务器返回 Last-Modefied 后浏览器保存为 If-Modified-Since；</li>
<li>之后浏览器每次发出请求，若未命中强制缓存，则携带 IMS；</li>
<li>服务器对比最后修改时间，如果修改时间一致，返回 304，否则返回最新资源和 200 状态码；</li>
<li>弊端一，秒级精确度，如果客户端请求的时候，服务端在同一秒修改了文件很多次，客户端只拿到了其中一个版本并缓存了下来，结果可能让缓存不是最新的；</li>
<li>弊端二，Last-Modified 的改变不代表资源内容的改变，例如使用服务端使用编辑器打开某资源，也可能导致 Last-Modified 更新，结果导致客户端缓存失效。</li>
</ul>
<p>Etag / If-None-Match：流程和 Last-Modifed/If-Modified-Since 一致；使用 Hash 判断资源是否被修改，因此不受秒级准确度限制，更精准。</p>
<p>缓存改进方案：md5 / hash 缓存和 CDN 缓存。</p>
<p>DNS Prefetch：打开后，浏览器提前将域名转为 IP 地址到浏览器 DNS 缓存中；<code>&lt;meta http-equiv=&quot;x-dns-prefetch-control&quot; content=&quot;on&quot;&gt;&lt;link rel=&quot;dns-prefetch&quot; href=&quot;//www.imooc.com&quot;&gt;</code></p>
<p>不能被缓存的请求：</p>
<ul>
<li>HTTPS 请求；</li>
<li>POST 请求；</li>
<li>HTTP 响应头中不包含 Last-Modified/Etag，不包含 Cache-Control/Expires 的请求；</li>
<li>HTTP 响应头中包含 Cache-Control:no-store（pragma:no-cache 不确定） 等告诉浏览器不用缓存的请求。</li>
</ul>
<p>对经常更新的文件使用<code>max-age</code>的问题：</p>
<ul>
<li>请求时间不一致问题——如果资源之间时相互依赖的，而请求时并不一定同时请求，就会造成过期时间不一致，当其中某个文件进行了更新，就可能破坏原有的依赖，导致客户端出现错误；</li>
<li>缓存丢失问题——如果丢失了某个经常被更新的文件的缓存，就会重新获取最新的该文件版本，这时可能破坏原有的依赖，和其它资源的过期时间不一样了，同样导致客户端出现错误；</li>
<li>如果某个资源不依赖其它资源，尽管经常更新，也可以使用<code>max-age</code>来减轻服务端的负担。</li>
</ul>
<p>问题：通过哪个字段反应第一次设置 max-age 的时间？</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://create-react-app.dev/docs/production-build/#static-file-caching">Static File Caching</a>——CRA 上介绍的 cache-control 缓存，当开启文件名哈希，为 index.html 不设置缓存，为静态资源设置缓存，例如 Cache-Control: max-age=31536000；</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/i13738612458/article/details/80383390">js 浏览器缓存机制</a>；</li>
<li><a target="_blank" rel="noopener" href="https://web.dev/http-cache/#flowchart">使用 HTTP 缓存避免不必要的网络请求</a>——有一张使用 cache-control 的流程图；</li>
<li>“<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/1046966/whats-the-difference-between-cache-control-max-age-0-and-no-cache">What’s the difference between Cache-Control: max-age=0 and no-cache?</a>”——<code>max-age=0 和 no-cache</code>的区别;</li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/54cc04190252">深入理解浏览器的缓存机制</a>；</li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/44596937/chrome-memory-cache-vs-disk-cache">Chrome memory cache vs disk cache</a>——关于浏览器缓存的“memory cache”和“disk cache”；</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Pragma%EF%BC%9Bhttps://stackoverflow.com/questions/7376515/what-are-the-valid-values-for-http-pragma">MDN-Pragma</a>；</li>
<li><a target="_blank" rel="noopener" href="https://jakearchibald.com/2016/caching-best-practices/">Caching best practices &amp; max-age gotchas</a>—— max-age 最佳实践。</li>
</ul>
<h2 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h2><p>关于状态码 304：请求协商缓存的时候服务端返回 304；搜索引擎会频繁抓取经常更新的网站，所以 304 可能降低网站曝光率。</p>
<table>
<thead>
<tr>
<th align="left">状态码</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">1xx</td>
<td align="left">告知请求的处理进度和情况</td>
</tr>
<tr>
<td align="left">2xx</td>
<td align="left">成功</td>
</tr>
<tr>
<td align="left">3xx</td>
<td align="left">表示需要进一步操作</td>
</tr>
<tr>
<td align="left">4xx</td>
<td align="left">客户端错误</td>
</tr>
<tr>
<td align="left">5xx</td>
<td align="left">服务端错误</td>
</tr>
</tbody></table>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38890412/article/details/105179214">Http状态码301和302理解以及使用场景</a>；</li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903519447678990#heading-7">具有代表性的 HTTP 状态码</a>；</li>
<li><a target="_blank" rel="noopener" href="https://http.cat/">HTTP Cats</a>——用猫表示状态码；</li>
<li><a target="_blank" rel="noopener" href="https://http.devtool.tech/">HTTP 状态码速查大全</a>。</li>
</ul>
<h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>关于 CORS（cross-origin resource sharing）：</p>
<ul>
<li>Cross-origin Resource Sharing，跨域资源共享；</li>
<li>当浏览器检测到请求是跨域的时候，会判断这个请求是简单请求还是非简单请求，对于不同的类型，服务器会响应不同的结果；</li>
<li>简单请求：<ul>
<li>请求方法只能是 HEAD、GET、POST；</li>
<li>头信息只能有 Accept、Accept-Language、Content-Language、Last-Event-ID、Content-Type，并且 Content-Type 的值只能是 application/x-www-form-urlencoded、multipart/form-data、text/plain；</li>
<li>浏览器发出简单请求的时候，会在头部添加字段 Origin，告诉服务器自己的协议、域名和端口号；</li>
<li>服务器会对简单请求作出回应，返回 3 个头部字段，分别是 Access-Control-Allow-Origin、Access-Control-Allow-Credentials（可选）和 Access-Control-Expose-Headers（可选）。</li>
</ul>
</li>
<li>非简单请求：<ul>
<li>发出非简答请求之前需要先发出预检请求，预检请求使用 OPTIONS 方法，预检请求会检查服务器支持的请求来源、请求动词以及请求头信息；</li>
<li>服务器对预检请求作出回应，返回 4 个头部字段，分别是 Access-Control-Allow-Methods、Access-Control-Allow-Headers、Access-Control-Allow-Credentials 和 Access-Control-Max-Age；</li>
<li>为了避免每一次非简单跨域请求都预检，就使用 Access-Control-Max-Age 字段来设置预检存活时长，在这一段时间里都不用额外发送预检请求。</li>
</ul>
</li>
<li>如果跨域请求失败，需要使用 XMLHttpRequest 的 onerror 捕获；</li>
<li>如果跨域请求需要 cookie，服务端响应时要设置头信息“<code>Access-Control-Allow-Credentials: true</code>”，浏览器要设置 XMLHttpRequest 实例的 withCredentials 为 true，“<code>var xhr = new XMLHttpRequest(); xhr.withCredentials = true;</code>”，如果要关闭，就设置为 false。</li>
</ul>
<p>关闭 Chrome 的同源策略，允许跨域：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># MacOS (in Terminal)</span><br><span class="line">open -na Google\ Chrome --args --user-data-dir=/tmp/temporary-chrome-profile-dir --disable-web-security --disable-site-isolation-trials</span><br></pre></td></tr></table></figure>

<p>关于 jsonp：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp</span>(<span class="params">&#123; url, params, callback &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">    <span class="variable language_">window</span>[callback] = <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">      <span class="title function_">resolve</span>(data);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(script);</span><br><span class="line">    &#125;;</span><br><span class="line">    params = &#123; ...params, callback &#125;; <span class="comment">// wd=b&amp;callback=show</span></span><br><span class="line">    <span class="keyword">let</span> arrs = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> params) &#123;</span><br><span class="line">      arrs.<span class="title function_">push</span>(<span class="string">`<span class="subst">$&#123;key&#125;</span>=<span class="subst">$&#123;params[key]&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?<span class="subst">$&#123;arrs.join(<span class="string">&quot;&amp;&quot;</span>)&#125;</span>`</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">jsonp</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;http://localhost:3000/say&quot;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123; <span class="attr">wd</span>: <span class="string">&quot;Iloveyou&quot;</span> &#125;,</span><br><span class="line">  <span class="attr">callback</span>: <span class="string">&quot;show&quot;</span></span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/04/cors.html">跨域资源共享 CORS 详解</a>——阮一峰的 CORS 教程；</li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/a/58658101">Disable-web-security in Chrome 48+</a>——关闭同源策略。</li>
</ul>
<h2 id="DNS（Domain-Name-System）"><a href="#DNS（Domain-Name-System）" class="headerlink" title="DNS（Domain Name System）"></a>DNS（Domain Name System）</h2><p>53 端口，域名解析时 UDP，区域同步传输 TCP。</p>
<p>使用名称而不是域名来确定通信对象的网络：Windows 网络的原型 PC-Network。</p>
<p>向 DNS 服务器发送的消息中包含三种：域名、Class 和记录类型。</p>
<p>记录类型：</p>
<ul>
<li>A，Address；</li>
<li>MX，Mail-Exchange，邮件交换；</li>
<li>PTR，根据 IP 地址反查域名；</li>
<li>CNAME，查询域名相关别名；</li>
<li>NS，查询 DNS 服务器的 IP 地址；</li>
<li>SOA，查询域名属性信息（P38）。</li>
</ul>
<p>域名用点分隔每个域，一个域的信息作为一个整体放在 DNS 服务器中，一个域不会拆开放在多台 DNS 服务器中。</p>
<p>DNS 服务器有缓存功能。</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2022/08/dns-query.html">DNS 查询原理详解</a></li>
</ul>
<h2 id="HTTPS"><a href="#HTTPS" class="headerlink" title="HTTPS"></a>HTTPS</h2><p>CA 证书，443 端口，SSL 加密传输。</p>
<p>SSL 协议的握手过程：</p>
<blockquote>
<p>第一步，爱丽丝给出<strong>协议版本号</strong>、一个<strong>客户端生成的随机数</strong>（Client random），以及<strong>客户端支持的加密方法</strong>。</p>
<p>第二步，鲍勃确认<strong>双方使用的加密方法</strong>，并给出<strong>数字证书</strong>、以及一个<strong>服务器生成的随机数</strong>（Server random）。</p>
<p>第三步，爱丽丝<strong>确认数字证书</strong>有效，然后<strong>生成一个新的随机数</strong>（Premaster secret），并<strong>使用数字证书中的公钥，加密这个随机数</strong>，发给鲍勃。</p>
<p>第四步，鲍勃<strong>使用自己的私钥，获取爱丽丝发来的随机数</strong>（即Premaster secret）。</p>
<p>第五步，爱丽丝和鲍勃<strong>根据约定的加密方法</strong>，使用前面的三个随机数，**生成”对话密钥”**（session key），用来加密接下来的整个对话过程。</p>
</blockquote>
<p>其中的协议版本号：94 年的 SSL 1.0，95 年的 SSL 2.0，96 年的 SSL 3.0，99 年的 TLS 1.0，06 年的 TLS 1.1，08 年的 TLS 1.2。</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2014/02/ssl_tls.html">SSL/TLS协议运行机制的概述</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html">图解SSL/TLS协议</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/27395037">HTTPS系列干货（一）：HTTPS 原理详解</a>——又拍云知乎教程。</li>
</ul>
<h2 id="数据收发"><a href="#数据收发" class="headerlink" title="数据收发"></a>数据收发</h2><p>MTU：Maximum Transmission Unit，最大传输单元。以太网中一般 1500 字节。</p>
<p>MSS：Maximum Segment Size，最大分段大小。MSS 减去 40 字节的 TCP 和 IP 头部大小，结果就是 MSS。也可以说一个网络包能容纳的最大数据长度就是 MSS。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">                      |-----------MTU-----------|</span><br><span class="line">报头/SFD   MAC 头部     IP头部      TCP 头部     数据       FCS</span><br><span class="line">                                        |--MSS--|</span><br></pre></td></tr></table></figure>

<p>SFD：Start Frame Delimiter，起始帧分界符。</p>
<p>FCS：</p>
<ul>
<li>Frame Check Sequence，帧校验序列；</li>
<li>用来检查传输过程中因噪声导致的波形紊乱，数据错误，长度为 32 比特；</li>
<li>计算公式相当于磁盘中使用的 CRC 错误校验码，Cyclic Redundancy check，循环冗余校验；</li>
<li>接收方计算的 FCS 和电信号里的 FCS 如果相同，代表数据正确。</li>
</ul>
<p>Mac 系统使用<code>netstat -rn</code>查看路由表。</p>
<p>MacOS 使用<code>arp -a</code>查询 ARP 缓存。</p>
<p>MAC：Media Access Control（p115）。</p>
<p>网卡发送数据包电信号的时候，通过“时钟信号+数据信号”的方式叠加发送（10BASE-T 的方式），接收方通过报头找到时钟信号的发送频率后，再通过异或计算，就能求出数据信号。</p>
<p>PHY/MAU：</p>
<ul>
<li>Physical Layer Device，物理层装置，Medium Attachment Unit，介质连接单元；</li>
<li>MAC 模块把数字信号转为电信号后，由称为 PHY 或 MAU 的信号收发模块发送出去；</li>
<li>PHY/MAU 的功能是对 MAC 模块产生的信号进行格式转换，以支持网线的传输格式。</li>
</ul>
<p>PnP：Plug and Play，即插即用（p124）。</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.wawajohn.net/12206.html">Mac 路由表相關筆記</a>；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2021/01/_xor.html">异或运算 XOR 教程</a>——“可以理解为 XOR 是更单纯的 OR 运算”；</li>
<li><a target="_blank" rel="noopener" href="https://m.ithome.com/html/645438.htm">最多能创建多少个 TCP 连接？</a>。</li>
</ul>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Get 请求的长度限制：由客户端和服务端决定，Chrome 限制 8182 比特，NGINX 默认限制 8k；IE 支持的长度最短，所以要兼容所有浏览器只要兼容 IE 就行了。</p>
<p>关于 http/2：</p>
<ul>
<li>SPDY 协议和 http/2；</li>
<li>http/2 仍然是无状态的，但是引入了索引表，索引表存储了字段信息；</li>
<li>关于 http/2 的命名，因为标准不打算给 http 出小版本，因此没有小数点，下一个版本是 http/3.</li>
</ul>
<p>关于 http/3：基于 UDP 实现了类似 TCP 的多路复用数据流、传输可靠性的功能，这套功能称为 QUIC 协议。</p>
<p>HTTP 的请求消息和响应消息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;方法&gt;&lt;空格&gt;&lt;URI&gt;&lt;空格&gt;&lt;HTTP 版本&gt;</span><br><span class="line">&lt;key&gt;:&lt;value&gt;</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">&lt;空行&gt;</span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;HTTP 版本&gt;&lt;空格&gt;&lt;状态码&gt;&lt;空格&gt;&lt;响应短语&gt;</span><br><span class="line">&lt;key&gt;:&lt;value&gt;</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">&lt;空行&gt;</span><br><span class="line">&lt;body&gt;</span><br></pre></td></tr></table></figure>

<p>避免 HTTP/2 之前版本的 6 个 TCP 连接限制：多域名部署（域名分片）。</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/08/http.html">HTTP 协议入门</a>——阮一峰的 Http 教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/04/cors.html">跨域资源共享 CORS 详解</a>——阮一峰的跨域资源共享教程；</li>
<li><a target="_blank" rel="noopener" href="https://runwei.blog.csdn.net/article/details/104179224">正向代理与反向代理的区别</a>；</li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/26559480">一文读懂 HTTP/2 特性</a>——又拍云知乎教程；</li>
<li><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2010/02/url_encoding.html">关于URL编码</a>——阮一峰的 URL 编码文章。</li>
</ul>
<h2 id="HTTP-方法"><a href="#HTTP-方法" class="headerlink" title="HTTP 方法"></a>HTTP 方法</h2><p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28586791/answer/767316172">GET 和 POST 到底有什么区别？</a>——知乎回答，对 GET POST 在浏览器和接口中的解释。</li>
</ul>
<h2 id="SEO"><a href="#SEO" class="headerlink" title="SEO"></a>SEO</h2><p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://developers.google.com/search/docs">SEO 谷歌文档</a>；</li>
<li><a target="_blank" rel="noopener" href="https://ahrefs.com/zh/seo">搜索引擎优化</a>—— ahrefs 的 SEO 教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.v2ex.com/t/886746#reply4">发现了不错的 SEO 教程</a>—— V2EX 关于 SEO 的帖子。</li>
</ul>
<h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><blockquote>
<p>“返回私密数据的mask，XSS，CSRF，跨域安全，前端加密，钓鱼，salt，……”——GET 和 POST 到底有什么区别？ - 大宽宽的回答 - 知乎<br><em><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28586791/answer/767316172">https://www.zhihu.com/question/28586791/answer/767316172</a></em></p>
</blockquote>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://ruby-china.org/topics/42753">【白话科普】从“熊猫烧香”聊聊计算机病毒</a>——又拍云在 Ruby 社区发布的系列文章。</li>
</ul>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>关于 http 和 tcp 关系的问题：</p>
<blockquote>
<p>应用程序收到组装好的原始数据，以浏览器为例，就会根据 HTTP 协议的Content-Length字段正确读出一段段的数据。这也意味着，一次 TCP 通信可以包括多个 HTTP 通信。——<em>‌<a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html">https://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html</a></em></p>
</blockquote>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/61423830">你猜一个 TCP 连接上面能发多少个 HTTP 请求</a>；</li>
<li><a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/microsoft-edge/devtools-guide-chromium/network/reference#timing-breakdown-phases-explained">Edge 计时细分阶段说明</a>——“已为此源打开六个 TCP 连接，这是限制。 仅适用于 HTTP/1.0 和 HTTP/1.1。”；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html#comment-377812">TCP 协议简介——评论</a>——“一次 TCP 通信包含多次 HTTP 通信，反之不成立。如果 HTTP 通信到一半， TCP 断了，就只能重新开始了。”</li>
</ul>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p>关于浏览器访问网站流程：解析URL &gt; 缓存判断 &gt; DNS &gt; 获取 MAC 地址 &gt; TCP 握手 &gt; HTTPS 握手 &gt; 响应 &gt; 页面渲染 &gt; 挥手</p>
<p>URL 的组成：协议 + 域名 + 端口 + 路径 + 文件 + 锚 + 参数</p>
<p>常见协议：HTTP、HTTPS、FTP、POP3、SMTP。</p>
<p>TCP 和 UDP 的场景：TCP 要准确度高的，如文件传输，UDP 视频、通话。</p>
<p>OSI 七层：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层。</p>
<p>URL 的各种形式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;http://user:password@www.a.com:90/dir/file1.htm&quot;</span> <span class="comment">// 用 HTTP 协议访问 Web 服务器</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;ftp://user:password@ftp.a.com:21/dir/file1.html&quot;</span>; <span class="comment">// 用 FTP 协议下载和上传文件</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;file://localhost/C:/path/file1.zip&quot;</span>; <span class="comment">// 读取客户端计算机本地文件</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;mailto:tone@a.com&quot;</span>; <span class="comment">// 发送电子邮件</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="string">&quot;news:comp.protocols.tcp-ip&quot;</span>; <span class="comment">// 阅读新闻组的文章</span></span><br></pre></td></tr></table></figure>

<p>IP 地址有网络号和主机号，但是 32 比特的 IP 不能直接区分，所以使用子网掩码来区分，子网掩码为 1 的部分是网络号，0 的部分是主机号。IP 地址的主机号为 0 表示子网，为 1 表示对子网进行广播。</p>
<p>子网掩码的形式：</p>
<ul>
<li>和 IP 格式相同，例如 255.255.255.0；</li>
<li>用比特数表示，例如 24（一个 255 占 8 比特，三个 255 就是 24 比特）。</li>
</ul>
<p>端口号和 IP 地址一样都是由 IANA（Internet Assigned Number Authority，互联网编号管理局）来管理的。</p>
<p>客户端通过 http 发出请求，tcp 进行握手，建立连接，tcp 把数据拆分成数据包，再经过网络层，链路层，物理层，直到服务端，当服务端做出响应，返回给客户端的时候，tcp 再组装数据，最后 http 收到响应。</p>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://support.microsoft.com/en-us/topic/maximum-url-length-is-2-083-characters-in-internet-explorer-174e7c8a-6666-f4e0-6fd6-908b53c12246">Maximum URL length is 2,083 characters in Internet Explorer</a>：IE GET 请求最长 2083 个字符；</li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE">传输控制协议</a>——wiki；</li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%B8%A7%E6%A0%BC%E5%BC%8F">以太网帧格式</a>——wiki。</li>
</ul>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p>资料：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2014/09/illustration-ssl.html">图解SSL/TLS协议</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1418457">终于有人把正向代理和反向代理解释的明明白白了！</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2022/08/dns-query.html">DNS 查询原理详解</a></li>
<li><a target="_blank" rel="noopener" href="https://http.cat/">HTTP Cats</a>：用猫表示状态码。</li>
<li><a target="_blank" rel="noopener" href="https://http.devtool.tech/">HTTP 状态码速查大全</a>；</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP">MDN-HTTP 文档</a>；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2012/05/internet_protocol_suite_part_i.html">互联网协议入门（一）</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2012/06/internet_protocol_suite_part_ii.html">互联网协议入门（二）</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2016/08/http.html">HTTP 协议入门</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2017/06/tcp-protocol.html">TCP 协议简介</a>——阮一峰教程；</li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/dog250/article/details/6612496">TCP协议疑难杂症全景解析</a>——作者是阮一峰 ssl 教程中提到的对“<a target="_blank" rel="noopener" href="https://blog.csdn.net/dog250/article/details/5717162">3 个随机数生成会话密钥</a>”问题进行解释的作者，dog250；</li>
<li><a target="_blank" rel="noopener" href="http://www.alloyteam.com/2020/05/14385/">HTTP/3 原理与实践</a>——腾讯博客。</li>
</ul>
<p>书籍：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.duozhuayu.com/books/72622000048179448">《网络是怎样连接的》</a></li>
<li><a target="_blank" rel="noopener" href="https://www.duozhuayu.com/books/31856832930644082">《图解 HTTP》</a></li>
<li><a target="_blank" rel="noopener" href="https://www.duozhuayu.com/books/49597779915312316">《图解 TCP/IP》</a></li>
</ul>
<p>相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=HT0xVY7i_DU">NGINX Max URL Length - 414 URI Too Large</a>：NGINX 默认 8k url 长度；</li>
<li><a target="_blank" rel="noopener" href="https://www.ruanyifeng.com/blog/2014/09/ssl-latency.html">SSL延迟有多大？</a>。</li>
</ul>


  </article>
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <div class="busuanzi center">
    页阅读量:&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;・&nbsp;
    站访问量:&nbsp;<span id="busuanzi_value_site_pv"></span>&nbsp;・&nbsp;
    站访客数:&nbsp;<span id="busuanzi_value_site_uv"></span>
  </div>


    





    </div>
  </div>
  <footer class="page-footer"><div class="clearfix">
</div>
<div class="right-foot">
    <div class="firstrow">
        <a href="#top" target="_self">
        <svg class="i-caret-right" viewBox="0 0 32 32" width="24" height="24" fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
            <path d="M10 30 L26 16 10 2 Z"></path>
        </svg>
        </a>
        © chen 2016-2021
    </div>
    <div class="secondrow">
        <a target="_blank" rel="noopener" href="https://www.poinotes.com/">
        Signal
        </a>
    </div>
</div>
<div class="clearfix">
</div>
</footer>
  <script src="//cdn.bootcss.com/jquery/2.2.1/jquery.min.js"></script>
<script src="/js/search.min.js"></script>
<script type="text/javascript">

// disqus scripts


// dropdown scripts
$(".dropdown").click(function(event) {
  var current = $(this);
  event.stopPropagation();
  $(current).children(".dropdown-content")[($(current).children(".dropdown-content").hasClass("open"))?'removeClass':'addClass']("open")
});
$(document).click(function(){
    $(".dropdown-content").removeClass("open");
})

var path = "/search.xml";
searchFunc(path, 'local-search-input', 'local-search-result');

</script>

</body>
</html>
